# Серверное приложение Colyseus

Этот документ описывает структуру и стек серверной части игрового проекта на базе Colyseus.

---

## Технологический стек

-   **Ядро:** Colyseus
-   **Веб-сервер:** Express
-   **Язык:** TypeScript
-   **ORM:** Prisma
-   **Аутентификация:** JSON Web Tokens (jsonwebtoken), bcrypt
-   **Тестирование:** Mocha, @colyseus/loadtest
-   **Кэширование / Сессии:** Redis (connect-redis, ioredis)

---

## Начало работы

1.  Установите зависимости:

    ```bash
    npm install
    ```

2.  Запустите сервер в режиме разработки:

    ```bash
    npm run dev
    ```

---

## Структура проекта

Файловая структура проекта организована следующим образом:

-   `app.ts`: Главная точка входа.
-   `package.json`: Определяет скрипты и зависимости проекта.
-   `tsconfig.json`: Конфигурация компилятора TypeScript.
-   `prisma/`: Содержит схему базы данных Prisma и файлы миграций.
-   `src/`: Основной исходный код приложения.
    -   `api/`: Маршруты и логика для REST API (Express).
    -   `configuration/`: Файлы конфигурации приложения.
    -   `controllers/`: Обработчики HTTP-запросов (контроллеры).
    -   `database/`: Модули для взаимодействия с базой данных (Prisma Client).
    -   `rooms/`: Логика игровых комнат Colyseus.
        -   `schema/`: Схемы состояния комнат (Colyseus Schema).
    -   `utils/`: Вспомогательные функции и утилиты.
-   `__tests__/`: Корневая папка для всех тестов.
    -   `loadtest/`: Скрипты для нагрузочного тестирования.
    -   `spec/`: Юнит-тесты и интеграционные тесты (Mocha).
-   `dist/`: Скомпилированный JavaScript код (игнорируется системой контроля версий).

---

## Основные скрипты

-   `npm build`: Компилирует проект в js код и сохраняет его в папку **dist**.
-   `npm start`: Запускает сервер в режиме production из папки **dist**.
-   `npm test`: Запускает набор тестов Mocha из папки `__tests__/spec`.
-   `npm run loadtest`: Запускает инструмент нагрузочного тестирования `@colyseus/loadtest`, используя скрипты из `__tests__/loadtest`.

---

## Лицензия

MIT
